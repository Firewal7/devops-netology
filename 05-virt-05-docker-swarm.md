## Домашнее задание к занятию "5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"

## Задача 1

- Дайте письменые ответы на следующие вопросы:

1) В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?
2) Какой алгоритм выбора лидера используется в Docker Swarm кластере?
3) Что такое Overlay Network?

# Ответ:

1) Для replication указываем количество реплик сервиса, которые запускаем. В global запускается одна реплика на каждом узле, заранее заданного количества реплик нет.
  
2) Лидер выбирается командой: docker swarm init.
Механизм выбора лидера основан на алгоритме raft, который включает в себя 3 принципа выбора лидера:
- Кандидат получает большинство голосов (включая свой) и побеждает в выборах.
- Кандидат получает сообщение от уже действующего лидера текущего срока или от любого сервера более старшего срока.
- Кандидат не получает за некоторый таймаут большинство голосов

3) Overlay network - это внутренняя виртуальная сеть кластера docker swarm, которая упрощает взаимодействие узлов кластера между собой.
  
## Задача 2

- Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

- Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:

```
docker node ls
```

![Ссылка 2](https://github.com/Firewal7/docker-swarm/blob/main/2.1.jpg)

## Задача 3

- Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

- Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
  
```
docker service ls
```
![Ссылка 3](https://github.com/Firewal7/docker-swarm/blob/main/3.1.jpg)

## Задача 4 

- Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:

- см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/

```
docker swarm update --autolock=true
```
![Ссылка 4](https://github.com/Firewal7/docker-swarm/blob/main/4.1.jpg)

- Команда docker swarm update --autolock=true позволяет зашифровать ключ шифрующий логи Raft и TLS ключ используемый для шифрования коммуникаций между нодами другим ключом, для дополнительной безопасности. Соответственно при перезагрузке ноды нужно будет ввести ключ расшифровки вышеуказанных ключей для успешной работы ноды.
